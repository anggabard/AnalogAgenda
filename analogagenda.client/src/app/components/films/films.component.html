<div class="container">
    <div class="header">
        <button class="add-film" (click)="onNewFilmClick()">+ New Film +</button>
    </div>

    <div class="tab-container">
        <div class="tabs">
            <button [class.active]="activeTab === 'my'" (click)="setActiveTab('my')">My Films</button>
            <button [class.active]="activeTab === 'all'" (click)="setActiveTab('all')">All Films</button>
        </div>
    </div>

    <div class="films-container" *ngIf="activeTab === 'my'">
        <app-film-search 
            [isMyFilmsTab]="true"
            [initialSearchParams]="myFilmsSearchParams"
            (search)="onSearch($event)"
            (clearFilters)="onClearFilters()">
        </app-film-search>

        <div class="films-section">
            <h2 class="films-title">Not Developed Films</h2>
            <app-card-list 
                [items]="myNotDevelopedFilms" 
                [cardTemplate]="myFilmCardTemplate"
                [hasMore]="hasMoreMyNotDeveloped" 
                [loading]="loadingMyNotDeveloped"
                (loadMore)="loadMoreMyNotDevelopedFilms()"
                (itemClick)="onFilmSelected($event.id)">
            </app-card-list>
        </div>

        <div class="films-section">
            <h2 class="films-title">Developed Films</h2>
            <app-card-list 
                [items]="myDevelopedFilms" 
                [cardTemplate]="myFilmCardTemplate"
                [hasMore]="hasMoreMyDeveloped" 
                [loading]="loadingMyDeveloped"
                (loadMore)="loadMoreMyDevelopedFilms()"
                (itemClick)="onFilmSelected($event.id)">
            </app-card-list>
        </div>
    </div>

    <div class="films-container" *ngIf="activeTab === 'all'">
        <app-film-search 
            [isMyFilmsTab]="false"
            [initialSearchParams]="allFilmsSearchParams"
            (search)="onSearch($event)"
            (clearFilters)="onClearFilters()">
        </app-film-search>

        <div class="films-section">
            <h2 class="films-title">Not Developed Films</h2>
            <app-card-list 
                [items]="allNotDevelopedFilms" 
                [cardTemplate]="allFilmCardTemplate"
                [hasMore]="hasMoreAllNotDeveloped" 
                [loading]="loadingAllNotDeveloped"
                (loadMore)="loadMoreAllNotDevelopedFilms()"
                (itemClick)="onFilmSelected($event.id)">
            </app-card-list>
        </div>

        <div class="films-section">
            <h2 class="films-title">Developed Films</h2>
            <app-card-list 
                [items]="allDevelopedFilms" 
                [cardTemplate]="allFilmCardTemplate"
                [hasMore]="hasMoreAllDeveloped" 
                [loading]="loadingAllDeveloped"
                (loadMore)="loadMoreAllDevelopedFilms()"
                (itemClick)="onFilmSelected($event.id)">
            </app-card-list>
        </div>
    </div>
</div>

<!-- Templates for different card types -->
<ng-template #myFilmCardTemplate let-film>
    <div class="card">
        <img class="image" [src]="film.imageUrl" />
        <span class="title">{{ film.name || film.brand }}</span>
        <span class="info type">{{film.type}}</span>
        <span class="info iso">ISO {{film.iso}}</span>
        <span class="info photos" *ngIf="film.photoCount && film.photoCount > 0">{{film.photoCount}}</span>
    </div>
</ng-template>

<ng-template #allFilmCardTemplate let-film>
    <div class="card">
        <img class="image" [src]="film.imageUrl" />
        <span class="title">{{ film.name || film.brand }}</span>
        <span class="info type">{{film.type}}</span>
        <span class="info iso">ISO {{film.iso}}</span>
        <span class="info owner">{{film.purchasedBy}}</span>
        <span class="info photos" *ngIf="film.photoCount && film.photoCount > 0">{{film.photoCount}}</span>
    </div>
</ng-template>